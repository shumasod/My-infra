`awk` は、テキストファイルの内容を解析し、パターンマッチングやテキストの加工を行うためのプログラム言語です。主に行と列に基づいたテキスト処理を行うためのツールであり、ログファイルやCSVファイルの処理に広く使われます。以下に、`awk` の基本知識を紹介します。

### 基本構文

`awk` スクリプトの基本構文は以下のようになります：

```sh
awk 'pattern { action }' input-file
```

- `pattern`: 行を選択するための条件式。省略すると、すべての行に対して `action` が適用されます。
- `action`: パターンに一致する行に対して行う処理。省略すると、`print $0`（行全体を表示）がデフォルトの動作となります。

### フィールドとレコード

- **レコード**: 通常、1行が1レコードと見なされます。`NR` は現在の行番号を示します。
- **フィールド**: レコードはフィールド（列）に分割されます。デフォルトのフィールド区切りは空白文字（スペースやタブ）です。`$1`, `$2`, `$3`, ... のようにアクセスします。

### オプション

- `-F`：フィールド区切り文字を指定します。
- `-v`：変数を `awk` スクリプトに渡します。

### 内部変数

- `NR`: 現在のレコード番号（行番号）。
- `NF`: 現在のレコードのフィールド数（列数）。
- `$0`: 現在のレコード全体。
- `$1`, `$2`, ...: 現在のレコードの各フィールド。

### 基本例

#### 1. ファイル全体を表示

```sh
awk '{ print $0 }' filename
```

これは、ファイルのすべての行を表示します。

#### 2. 特定のフィールドを表示

```sh
awk '{ print $1, $3 }' filename
```

これは、各行の1列目と3列目を表示します。

#### 3. フィールド区切りを変更

```sh
awk -F, '{ print $1, $2 }' filename.csv
```

これは、カンマ区切りのCSVファイルの1列目と2列目を表示します。

#### 4. 条件に一致する行を表示

```sh
awk '$3 > 100' filename
```

これは、3列目の値が100より大きい行を表示します。

#### 5. 行番号を表示

```sh
awk '{ print NR, $0 }' filename
```

これは、各行の前に行番号を付けて表示します。

#### 6. 合計を計算

```sh
awk '{ sum += $3 } END { print sum }' filename
```

これは、3列目の合計を計算して表示します。

### パターンの種類

- **正規表現**：行が特定の正規表現にマッチする場合。
  ```sh
  awk '/pattern/ { print $0 }' filename
  ```
- **範囲パターン**：開始パターンから終了パターンまでの範囲内の行。
  ```sh
  awk '/start/, /end/ { print $0 }' filename
  ```

### BEGIN と END ブロック

- `BEGIN`：入力ファイルの処理を開始する前に実行されるアクション。
- `END`：すべての入力が処理された後に実行されるアクション。

```sh
awk 'BEGIN { print "Start processing" }
     { print $1 }
     END { print "End processing" }' filename
```

このスクリプトは、処理の前に "Start processing" を表示し、各行の1列目を表示し、最後に "End processing" を表示します。

`awk` は非常に強力なツールであり、これらの基本を組み合わせて複雑なテキスト処理を簡単に行うことができます。
