#!/usr/bin/env bash
# -*- coding: utf-8 -*-

# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘      è¶…é«˜é€Ÿã†ã©ã‚“è¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ  v3.0       â•‘
# â•‘       ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸è¦ãƒ»å³è¡¨ç¤ºï¼         â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

set -euo pipefail

# ã‚«ãƒ©ãƒ¼ã‚’å®šç¾©ï¼ˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãŒå¯¾å¿œã—ã¦ã‚‹å ´åˆã®ã¿ï¼‰
RED='\e[31m'
GREEN='\e[32m'
YELLOW='\e[33m'
BLUE='\e[34m'
MAGENTA='\e[35m'
CYAN='\e[36m'
BOLD='\e[1m'
RESET='\e[0m'

# ã†ã©ã‚“ã‚¢ãƒ¼ãƒˆãŸã¡
show_kamonegi() {
    clear
    cat << 'EOF'

         â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
         â•‘      é´¨è‘±ã†ã©ã‚“ æ¥µã¿       â•‘
         â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

               ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½
              (   ã‚ã¤ã‚ã¤ã®é´¨ã ã—   )
               ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½

                  ğŸ¦†   â•­â”€â”€â”€â”€â”€â•®   ğŸŸ¢ğŸŸ¢
                 é´¨è‚‰  â”‚ éºº  â”‚  ä¹æ¡ãƒã‚®
                        â•°â”€â”€â”€â”€â”€â•¯

         é´¨ã®è„‚ãŒã˜ã‚…ã‚ã£ã¨æº¶ã‘å‡ºã™â€¦æœ€å¼·ã®ä¸€æ¯ï¼

    ã€ã‚«ãƒ­ãƒªãƒ¼ã€‘ç´„450kcal   ã€å¹¸ç¦åº¦ã€‘â˜…â˜…â˜…â˜…â˜…

    ã„ãŸã ãã¾ã™ï¼ï¼ï¼ ğŸœâœ¨

EOF
    sleep 0.8
}

show_kitsune() {
    clear
    cat << 'EOF'

         â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
         â•‘        ãã¤ã­ã†ã©ã‚“           â•‘
         â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

               ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½
              (  ç”˜è¾›ã ã—ãŒæŸ“ã¿ãŸâ€¦  )
               ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½

                     ğŸŸ«ğŸŸ«
                    ğŸ¦Š ãŠæšã’ ğŸ¦Š
                     ğŸŸ«ğŸŸ«
                    â•­â”€â”€â”€â”€â”€â•®
                    â”‚ éºº  â”‚
                    â•°â”€â”€â”€â”€â”€â•¯

         é–¢è¥¿é¢¨ç”˜è¾›ãŠæšã’ãŒä¸»å½¹ã®å„ªã—ã„å‘³

    ã»ã£ã“ã‚Šâ€¦ãŠè…¹ã‚‚å¿ƒã‚‚æ¸©ã¾ã‚‹ä¸€æ¯

EOF
}

show_tempura() {
    clear
    cat << 'EOF'

         â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
         â•‘       å¤©ã·ã‚‰ã†ã©ã‚“ è±ªå¿«       â•‘
         â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

               ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½
              (   ç†±ã€…å¤©ã¤ã‚†ã ã—    )
               ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½

                       ğŸ¤ğŸ¤
                      æµ·è€å¤©ã·ã‚‰ï¼
                       ğŸ¤ğŸ¤
                        â”‚
                   â•­â”€â”€â”€â”€â”€â”€â”€â”€â•®
                   â”‚  è®ƒå²ã†ã©ã‚“  â”‚
                   â•°â”€â”€â”€â”€â”€â”€â”€â”€â•¯

         ã‚µã‚¯ãƒƒï¼ã‚¸ãƒ¥ãƒ¯ãƒƒï¼ç„¡æ•µã®çµ„ã¿åˆã‚ã›ï¼

EOF
}

show_tsukimi() {
    clear
    cat << 'EOF'

         â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
         â•‘        æœˆè¦‹ã†ã©ã‚“           â•‘
         â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

               ğŸŒ•
                  ã¨ã‚ã€œã‚Šé»„èº«ãŒâ€¦

               ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½
              (  å„ªã—ã„å’Œé¢¨ã ã—   )
               ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½

                     ğŸ¥š
                    é»„èº«ãŒã¨ã‚ã‘ã‚‹â€¦
                     â•­â”€â”€â”€â•®
                     â”‚éººâ”‚
                     â•°â”€â”€â”€â•¯

         æœˆå¤œã«é£Ÿã¹ãŸã„â€¦ç™’ã—ã®ä¸€æ¯

EOF
}

show_tanuki() {
    clear
    echo -e "${MAGENTA}"
    cat << 'EOF'

         â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
         â•‘        ãŸã¬ãã†ã©ã‚“           â•‘
         â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

               ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½
              (  å¤©ã‹ã™ã–ã£ãã–ãï¼   )
               ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½

                    ğŸŒ¾ğŸŒ¾ğŸŒ¾
                   å¤©ã‹ã™å±±ç››ã‚Šï¼
                    ğŸŒ¾ğŸŒ¾ğŸŒ¾
                     â•­â”€â”€â”€â•®
                     â”‚éººâ”‚
                     â•°â”€â”€â”€â•¯

         ã‚«ãƒªã‚«ãƒªå¤©ã‹ã™ãŒæ­¢ã¾ã‚‰ãªã„â€¦ç„¡é™ãƒ«ãƒ¼ãƒ—ã†ã©ã‚“

EOF
    echo -e "${RESET}"
}

# ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆã‚«ãƒ¼ã‚½ãƒ«æ“ä½œå¯¾å¿œï¼ï¼‰
show_udon_menu() {
    clear
    local options=(
        "é´¨è‘±ã†ã©ã‚“ï¼ˆç‹é“ã®æ¥µã¿ï¼‰"
        "ãã¤ã­ã†ã©ã‚“ï¼ˆç”˜å…šå°‚ç”¨ï¼‰"
        "å¤©ã·ã‚‰ã†ã©ã‚“ï¼ˆãƒœãƒªãƒ¥ãƒ¼ãƒ é‡è¦–ï¼‰"
        "æœˆè¦‹ã†ã©ã‚“ï¼ˆç™’ã—ç³»ï¼‰"
        "ãŸã¬ãã†ã©ã‚“ï¼ˆå¤©ã‹ã™ç„¡åŒï¼‰"
        "â†’ ãƒ©ãƒ³ãƒ€ãƒ ã§é¸ã¶ï¼"
        "â†’ çµ‚äº†ã™ã‚‹"
    )

    local selected=0
    local key

    trap 'tput cnorm; clear; exit 0' INT TERM

    tput civis  # ã‚«ãƒ¼ã‚½ãƒ«éè¡¨ç¤º

    while true; do
        clear
        echo -e "${CYAN}${BOLD}"
        cat << 'EOF'
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘          ä»Šæ—¥ã®ã†ã©ã‚“ã‚’é¸ã¹ï¼          â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EOF
        echo -e "${RESET}"

        for i in "${!options[@]}"; do
            if [[ $i -eq $selected ]]; then
                echo -e "${YELLOW}â¤ ${options[i]}${RESET}"
            else
                echo "  ${options[i]}"
            fi
        done

        echo
        echo -e "${GREEN}â†‘â†“ã§ç§»å‹•ã€Enterã§æ±ºå®šã€qã§çµ‚äº†${RESET}"

        read -rsn1 key
        case "$key" in
            $'\x1b') # ESCã‚·ãƒ¼ã‚±ãƒ³ã‚¹
                read -rsn2 key
                case "$key" in
                    '[A') ((selected--));;
                        ((selected < 0)) && selected=$((${#options[@]}-1)) ;;
                    '[B') ((selected++));
                        ((selected >= ${#options[@]})) && selected=0 ;;
                esac
                ;;
            ''|13) break ;;  # Enter
            q|Q) clear; echo "ã¾ãŸæ¥ã¦ã­ï¼"; tput cnorm; exit 0 ;;
        esac
    done

    tput cnorm

    case $selected in
        0) show_kamonegi ;;
        1) show_kitsune ;;
        2) show_tempura ;;
        3) show_tsukimi ;;
        4) show_tanuki ;;
        5) 
            local r=$((RANDOM % 5))
            case $r in
                0) show_kamonegi ;;
                1) show_kitsune ;;
                2) show_tempura ;;
                3) show_tsukimi ;;
                4) show_tanuki ;;
            esac
            ;;
        6) clear; echo -e "${RED}ã¾ãŸæ¥ã¦ã­ï¼ã¾ãŸã­ï¼${RESET}"; exit 0 ;;
    esac

    echo
    read -n1 -s -rp "Press any key to return to menu..." 
    show_udon_menu
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
main() {
    case "${1:-menu}" in
        kamonegi|é´¨è‘±|kamo) show_kamonegi ;;
        kitsune|ãã¤ã­) show_kitsune ;;
        tempura|å¤©ã·ã‚‰) show_tempura ;;
        tsukimi|æœˆè¦‹) show_tsukimi ;;
        tanuki|ãŸã¬ã) show_tanuki ;;
        menu|""|-m|--menu) show_udon_menu ;;
        random|r) 
            local r=$((RANDOM % 5))
            case $r in
                0) show_kamonegi ;;
                1) show_kitsune ;;
                2) show_tempura ;;
                3) show_tsukimi ;;
                4) show_tanuki ;;
            esac
            ;;
        *) 
            echo "ä½¿ã„æ–¹: $0 [kamonegi|kitsune|tempura|tsukimi|tanuki|random|menu]"
            echo "        $0        # â†’ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ¡ãƒ‹ãƒ¥ãƒ¼èµ·å‹•ï¼"
            ;;
    esac
}

# å®Ÿè¡Œï¼
main "$@"